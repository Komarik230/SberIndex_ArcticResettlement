<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–û—Å—Ç–∞—Ç—å—Å—è ‚Äî –∫–∞—Ä—Ç–∞ (—Å–µ–≤–µ—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ)</title>

    <!-- –®–†–ò–§–¢–´ -->
    <style>
        @font-face {
          font-family: 'Druk';
          src: url('/static/fonts/DrukTextWideCyTT-Heavy.ttf') format('truetype');
          font-weight: 900;
        }

        html, body {
          margin: 0;
          padding: 0;
          width: 100%;
          height: 250vh; /* –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –ø–æ–¥ –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç */
          overflow-x: hidden;
          background: #0a1e3d; /* —Å–≤–µ—Ç–ª—ã–π —Å–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ–Ω */
        }

        canvas#auroraCanvas {
          position: fixed;
          inset: 0;
          width: 100vw;
          height: 100vh;
          z-index: 1;
          pointer-events: none;
        }

        object#map {
          width: 100vw;
          height: 100vh;
          z-index: 2;
          position: relative;
          display: block;
        }

        /* –õ–ï–ì–ï–ù–î–ê */
        #legend {
          position: fixed;
          left: 24px;
          top: 24px;
          width: 180px;
          opacity: 0.9;
          pointer-events: none;
          z-index: 3;
          transition: opacity 0.45s ease, transform 0.45s ease;
        }
        #legend.hidden {
          opacity: 0;
          transform: translateY(-20px);
        }

        /* –ü–£–õ–¨–°–ê–¶–ò–Ø –¢–û–ß–ï–ö */
        @keyframes pulse {
          0%   { transform: scale(1); opacity: 0.7; }
          50%  { transform: scale(1.5); opacity: 1; }
          100% { transform: scale(1); opacity: 0.7; }
        }

        /* –ü–ï–†–ï–•–û–î–ù–´–ô –¢–ï–ö–°–¢ */
        #transitionText {
          width: 100%;
          text-align: center;
          margin-top: 120px;
          font-family: 'Druk', sans-serif;
          font-size: 44px;
          font-weight: 900;
          line-height: 1.25;
          letter-spacing: 0.5px;
          color: white;
          text-transform: uppercase;
          z-index: 4;
          position: relative;
          pointer-events: none;
        }

        #afterImage {
          width: 100%;
          max-width: 1100px;
          display: block;

          /* üî• –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –æ—Ç—Å—Ç—É–ø—ã —Å–≤–µ—Ä—Ö—É –∏ —Å–Ω–∏–∑—É */
          margin: 120px auto 120px;

          position: relative;
          z-index: 2;
        }
    </style>
</head>

<body>

<!-- –°–ò–Ø–ù–ò–ï -->
<canvas id="auroraCanvas"></canvas>

<!-- –õ–ï–ì–ï–ù–î–ê -->
<object id="legend" type="image/svg+xml" data="/static/Group 1.svg"></object>

<!-- –ö–ê–†–¢–ê -->
<object id="map" type="image/svg+xml"
        data="/static/–ö–∞—Ä—Ç–∞_1_pora_data-dataframe.svg"></object>

<!-- –ü–ï–†–ï–•–û–î–ù–´–ô –¢–ï–ö–°–¢ -->
<div id="transitionText">
    –õ—é–¥–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –ê—Ä–∫—Ç–∏–∫–µ.<br>
    –ö—Ç–æ-—Ç–æ –¥–∞–∂–µ –ø—Ä–∏–µ–∑–∂–∞–µ—Ç.<br>
    <br>
    –ü–æ—á–µ–º—É?<br>
    <br>
    –û—Ç–≤–µ—Ç–æ–≤ –º–Ω–æ–≥–æ.<br>
    –ù–æ, –º–æ–∂–µ—Ç –±—ã—Ç—å, –≤–∞–∂–Ω–µ–µ –¥—Ä—É–≥–æ–µ ‚Äî<br>
    –ø–æ–Ω—è—Ç—å, —á—Ç–æ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ç–µ –º–µ—Å—Ç–∞, <br>
    –≥–¥–µ –∂–∏–∑–Ω—å –Ω–µ –∑–∞–º–µ—Ä–∑–∞–µ—Ç.<br>
</div>



<object id="afterImage"
        type="image/svg+xml"
        data="/static/Frame2.svg"></object>

<script>
    // =============================
    // –ú–´–®–¨ (–¥–≤–∏–∂–µ–Ω–∏–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–∏—è–Ω–∏–µ)
    // =============================
    let mouseX = 0;
    let mouseY = 0;
    window.addEventListener("mousemove", (e) => {
      mouseX = e.clientX / innerWidth;
      mouseY = e.clientY / innerHeight;
    });

    // =============================
    // CANVAS ‚Äî —Ç—É–º–∞–Ω–Ω–æ–µ —Å–µ–≤–µ—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ
    // =============================
    const canvas = document.getElementById("auroraCanvas");
    const ctx = canvas.getContext("2d");

    function resize() {
      canvas.width = innerWidth;
      canvas.height = innerHeight;
    }
    resize();
    window.addEventListener("resize", resize);

    let t = 0;

    const clouds = [
      { color: "rgba(255, 120, 160, 0.20)", size: 480 },
      { color: "rgba(120, 200, 255, 0.25)", size: 560 },
      { color: "rgba(120, 255, 190, 0.20)", size: 620 },
      { color: "rgba(180, 140, 255, 0.18)", size: 520 },
      { color: "rgba(255, 255, 180, 0.16)", size: 750 }
    ];

    function drawAurora() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // –§–û–ù
      const bg = ctx.createLinearGradient(0, 0, 0, canvas.height);
      bg.addColorStop(0, "#0b2a55");
      bg.addColorStop(1, "#0f305a");
      ctx.fillStyle = bg;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // –û–ë–õ–ê–ö–ê –°–ò–Ø–ù–ò–Ø
      clouds.forEach((c, i) => {
        const x =
          canvas.width *
          (0.3 + 0.4 * Math.sin(t / (260 + i * 40)) + (mouseX - 0.5) * 0.25);

        const y =
          canvas.height *
          (0.4 + 0.3 * Math.cos(t / (280 + i * 50)) + (mouseY - 0.5) * 0.25);

        const radius = c.size + Math.sin(t / (90 + i * 25)) * 35;

        const grad = ctx.createRadialGradient(x, y, 0, x, y, radius);
        grad.addColorStop(0, c.color);
        grad.addColorStop(1, "transparent");

        ctx.globalCompositeOperation = "lighter";
        ctx.fillStyle = grad;
        ctx.beginPath();
        ctx.arc(x, y, radius, 0, Math.PI * 2);
        ctx.fill();
      });

      ctx.globalCompositeOperation = "source-over";

      t += 1;
      requestAnimationFrame(drawAurora);
    }

    drawAurora();

    // =============================
    // –ü–£–õ–¨–°–ê–¶–ò–Ø –ì–û–õ–£–ë–´–• –¢–û–ß–ï–ö (rect) ‚Äî –†–ê–ë–û–ß–ê–Ø
    // =============================
    window.addEventListener("load", () => {
      const map = document.getElementById("map");

      function startAnimation(svg) {
        if (!svg) return;

        // –ù–ê–•–û–î–ò–ú –í–°–ï <rect> C –ù–£–ñ–ù–´–ú–ò –ì–û–õ–£–ë–´–ú–ò –û–¢–¢–ï–ù–ö–ê–ú–ò
        const dots = svg.querySelectorAll(`
          rect[fill="#9CF4EE"], rect[fill="#A9DCCE"], rect[fill="#B7C5AE"],
          rect[fill="#9cf4ee"], rect[fill="#a9dcce"], rect[fill="#b7c5ae"],
          rect[style*="9CF4EE"], rect[style*="A9DCCE"], rect[style*="B7C5AE"],
          rect[style*="9cf4ee"], rect[style*="a9dcce"], rect[style*="b7c5ae"],
          rect[fill*="rgb(156"], rect[fill*="rgb(169"], rect[fill*="rgb(183"]
        `);

        dots.forEach(dot => {
          let scale = 1;
          let growing = true;

          // —Ü–µ–Ω—Ç—Ä –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
          const x = parseFloat(dot.getAttribute("x"));
          const y = parseFloat(dot.getAttribute("y"));
          const w = parseFloat(dot.getAttribute("width"));
          const h = parseFloat(dot.getAttribute("height"));

          dot.setAttribute(
            "transform-origin",
            `${x + w / 2} ${y + h / 2}`
          );

          function pulse() {
            if (growing) {
              scale += 0.01;
              if (scale >= 1.45) growing = false;
            } else {
              scale -= 0.01;
              if (scale <= 1) growing = true;
            }

            dot.setAttribute("transform", `scale(${scale})`);

            requestAnimationFrame(pulse);
          }

          pulse();
        });
      }

      // SVG —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω
      if (map.contentDocument)
        startAnimation(map.contentDocument);

      // SVG –¥–æ–≥—Ä—É–∑–∏—Ç—Å—è –ø–æ–∑–∂–µ
      map.addEventListener("load", () =>
        startAnimation(map.contentDocument)
      );
    });

    // =============================
    // –õ–ï–ì–ï–ù–î–ê: –∏—Å—á–µ–∑–∞–µ—Ç –≤–Ω–∏–∑, –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤–≤–µ—Ä—Ö
    // =============================
    const legend = document.getElementById("legend");
    let lastScroll = 0;

    window.addEventListener("scroll", () => {
      const current = scrollY;

      if (current > lastScroll + 20) {
        legend.classList.add("hidden");
      } else if (current < lastScroll - 20) {
        legend.classList.remove("hidden");
      }

      lastScroll = current;
    });
</script>


</body>
</html>
